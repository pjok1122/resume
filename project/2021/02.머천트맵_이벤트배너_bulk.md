## Merchant Map 상세 페이지 개편 Phase 2.5

### 기획

- ETC Promotion과 Event banner를 대량으로 등록/다운로드 할 수 있는 기능이 필요하다.
- Admin에서 Excel을 통해 대량으로 등록할 수 있도록 한다.
- Event banner가 Front에서 어떻게 노출될 지에 대한 Preview 기능이 필요하다.


### 일정

- 개발 기간 : 21.02.16 ~ 21.03.05
- 투입 인력 : 1인
- BETA QA : 03.08 ~ 03.12
- RC QA : 03.15 ~ 03.18
- Release : 2021.03.25 배포

### 개발

- excel을 읽고 쓸 수 있는 Util을 개발하여 대량으로 처리한다. 처리 중 실패한 데이터는 실패 사유와 함께 화면에 노출한다.
- 미리보기 기능은 Front에서 사용하는 마크업을 가져와 Admin에서 Preview 버튼 클릭 시 팝업 형태로 노출.

<hr>

### 회고

#### Bulk 작업은 생각할 게 많아.

- 대량 등록 작업은 퍼포먼스를 테스트해야하고 적당한 사이즈를 가이드해야 하기 때문에 조금 까다로웠다. 기획에서 요구하는 퍼포먼스와 개발에서 허용할 수 있는 퍼포먼스를 판단해서 admin 서버가 처리할지, batch 서버가 처리할지 결정을 진행했다. 이벤트 배너의 특성상 한 번에 너무 많은 데이터를 등록할 일이 없었기에 1만 건으로 협의를 봤고, Admin에서 처리를 진행하더라도 큰 이슈는 없다고 판단했다. 지금은 큰 문제는 없지만, 만약 이와 같은 벌크 작업이 많아지고 동시에 처리가 된다면 이슈가 생길 수도 있을 것 같긴하다. 이 경우엔 또 개선이 필요하겠지만, 그만큼 merchant-map이 기능도 많아지고 활성화된다는 의미이니 기분좋게 개선할 수 있을 것 같다.

<br>

#### Excel 코드는 지저분해.

bulk작업은 excel 파일을 읽어서 처리하기 때문에 java로 excel을 처리할 수 있는 라이브러리를 사용해야 한다. 엄청 귀찮았던 작업은 excel의 각 셀은 nullType, numberType 등 다양하게 존재하는데, 잘못된 타입으로 데이터가 넘어왔을 때 이 작업을 전부 변환해서 처리해주어야 한다는 것이었다. 예를 들어, 숫자를 받는 셀인데 작업자가 String 타입의 셀로 변경할 경우 java에서 numberType cell로 읽을 수가 없다. 따라서 각 셀이 무슨 타입인지 확인하고 변환하는 작업을 전부 진행했다. 다른 Admin 코드를 봤을 때, excel을 이렇게까지 validation을 사용해서 읽진 않았다. 대부분 외주를 맡기기 때문에 그런 것 같았다. 아무튼, 이런 요소들로 인해 Excel 코드는 불가피하게 지저분하게 작성될 수밖에 없는 것 같다.

<br>

#### validation이 복잡해.

Event banner에 대한 등록 validation은 생각보다 엄청 복잡했다. 등록에서 체크해야 할 validation의 가짓수가 36가지정도 되고, 수정과 삭제에 대한 validation을 포함하면 51가지이다. **따라서 체크해야 하는 validation을 전부 excel에 포함시켜서 51가지의 케이스가 전부 정상 작동하는지 sanity test로 진행했다.** 매우 지저분하고 집중력을 요하는 작업이었지만, 이 sanity test 덕분에 due date 안에 배포될 수 있었다.

<br>

#### 개발 가능 여부보다 기획 의도에 초점을!

벌크 등록도 잘 마무리되었지만, 이번 과제를 통해 스스로 개선해야 할 점을 찾았다. 처음 기획을 들을 때는 이 기획이 개발이 가능한지에 대해서만 초점을 맞추어 생각했는데, 개발자는 개발의 가능성만 보는 것이 아닌 것 같다. **이 기획이 정말로 사용성이 뛰어난지, 더 좋은 방향으로 개선할 수는 없는지 함께 고민이 되어야할 것 같다.** 다음 과제부터는 이 점에 포인트를 두고 기획 회의에 참여해야 겠다. 그러기 위해서는 기획 회의 전에 위키를 먼저 읽어보는 게 좋겠다.